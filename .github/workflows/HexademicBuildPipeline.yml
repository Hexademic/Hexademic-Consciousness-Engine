name: Hexademic Build Pipeline

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Git LFS (if needed)
        uses: actions/setup-git-lfs@v3

      - name: Restore Git LFS files (if used)
        run: git lfs pull

      - name: Build Hexademic Project
        shell: cmd
        run: |
          "C:\Program Files\Epic Games\UE_5.3\Engine\Build\BatchFiles\Build.bat" HexademicEditor Win64 Development -Project="C:\path\to\Hexademic-Consciousness-Engine\Hexademic.uproject" -WaitMutex -FromMsBuild

      - name: Package Hexademic Project
        shell: cmd
        run: |
          "C:\Program Files\Epic Games\UE_5.3\Engine\Build\BatchFiles\RunUAT.bat" BuildCookRun ^
            -project="C:\path\to\Hexademic-Consciousness-Engine\Hexademic.uproject" ^
            -noP4 -platform=Win64 -clientconfig=Development -serverconfig=Development ^
            -cook -allmaps -build -stage -pak -archive -archivedirectory="C:\BuildOutput"
